@{
    ViewData["Title"] = "General Ledger";
    Layout = "~/Views/Shared/_SuperAdminLayout.cshtml";
}

<div class="page-header">
    <div class="d-flex justify-content-between align-items-start flex-wrap gap-2">
        <div>
            <p class="text-muted mb-0">Accounting</p>
            <h1 class="page-title">General Ledger</h1>
            <p class="page-subtitle">Platform-level general ledger with posted journal entries and system transactions.</p>
        </div>
    </div>
</div>

<!-- Stats -->
<div class="stat-cards">
    <div class="stat-card fade-in stagger-1">
        <div class="stat-info"><span class="stat-label">Total Entries</span><span class="stat-value" id="glTotalEntries">0</span></div>
        <div class="stat-icon teal"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg></div>
    </div>
    <div class="stat-card fade-in stagger-2">
        <div class="stat-info"><span class="stat-label">Total Debits</span><span class="stat-value" id="glTotalDebits">₱0</span></div>
        <div class="stat-icon green"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg></div>
    </div>
    <div class="stat-card fade-in stagger-3">
        <div class="stat-info"><span class="stat-label">Total Credits</span><span class="stat-value" id="glTotalCredits">₱0</span></div>
        <div class="stat-icon blue"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 18 13.5 8.5 8.5 13.5 1 6"/><polyline points="17 18 23 18 23 12"/></svg></div>
    </div>
    <div class="stat-card fade-in stagger-4">
        <div class="stat-info"><span class="stat-label">System Entries</span><span class="stat-value" id="glSystemEntries">0</span></div>
        <div class="stat-icon orange"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg></div>
    </div>
</div>

<!-- Filters -->
<div class="card fade-in mb-3 mt-3">
    <div class="card-body">
        <div class="d-flex gap-3 align-items-end flex-wrap">
            <div class="form-group mb-0 flex-grow-1">
                <label class="form-label">Search</label>
                <input type="text" class="form-control" id="glSearch" placeholder="Search by account or description..." oninput="GLModule.currentPage=1;GLModule.render()">
            </div>
            <div class="form-group mb-0">
                <label class="form-label">Account</label>
                <select class="form-control" id="glAccountFilter" onchange="GLModule.load()">
                    <option value="">All Accounts</option>
                </select>
            </div>
            <div class="form-group mb-0">
                <label class="form-label">Source</label>
                <select class="form-control" id="glSourceFilter" onchange="GLModule.currentPage=1;GLModule.render()">
                    <option value="">All Sources</option>
                    <option value="Manual">Manual</option>
                    <option value="System">System</option>
                </select>
            </div>
            <div class="form-group mb-0">
                <label class="form-label">Date From</label>
                <input type="date" class="form-control" id="glDateFrom" onchange="GLModule.load()">
            </div>
            <div class="form-group mb-0">
                <label class="form-label">Date To</label>
                <input type="date" class="form-control" id="glDateTo" onchange="GLModule.load()">
            </div>
        </div>
    </div>
</div>

<!-- Ledger Table -->
<div class="card fade-in mb-3">
    <div class="card-body" style="padding:0;">
        <div class="data-table-wrapper">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Code</th>
                        <th>Account</th>
                        <th>Description</th>
                        <th>Source</th>
                        <th class="text-end">Debit</th>
                        <th class="text-end">Credit</th>
                        <th>Reference</th>
                        <th class="text-center">Actions</th>
                    </tr>
                </thead>
                <tbody id="glTableBody">
                    <tr><td colspan="9" class="text-center py-4">Loading...</td></tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="card-footer d-flex justify-content-between align-items-center" id="glPagination"></div>
</div>

<!-- Trial Balance / Account Summary -->
<div class="card fade-in">
    <div class="card-body">
        <h5 class="mb-3" style="font-weight:600;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-2" style="vertical-align:middle;">
                <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/>
            </svg>
            Account Summary (Trial Balance)
        </h5>
        <div class="data-table-wrapper">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Code</th>
                        <th>Account Name</th>
                        <th>Type</th>
                        <th class="text-end">Total Debit</th>
                        <th class="text-end">Total Credit</th>
                    </tr>
                </thead>
                <tbody id="glSummaryBody">
                    <tr><td colspan="5" class="text-center py-3">Loading...</td></tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/superadmin-accounting.js" asp-append-version="true"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => GLModule.load());
    </script>
}
